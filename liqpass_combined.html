<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="robots" content="noindex,nofollow" />
    <title>LiqPass — 爆仓保 (功能 + 帮助文档)</title>
    <script src="https://cdn.tailwindcss.com?plugins=typography"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
    <style>
      * { box-sizing: border-box; }
      body { font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; }
      .markdown-content h2 { font-size: 1.5rem; font-weight: 600; margin-top: 1.5rem; margin-bottom: 1rem; }
      .markdown-content h3 { font-size: 1.25rem; font-weight: 600; margin-top: 1.25rem; margin-bottom: 0.75rem; }
      .markdown-content p { margin-bottom: 0.75rem; line-height: 1.6; }
      .markdown-content ul, .markdown-content ol { margin-bottom: 0.75rem; padding-left: 1.5rem; }
      .markdown-content li { margin-bottom: 0.5rem; }
      .markdown-content a { color: #60a5fa; text-decoration: underline; }
      .markdown-content blockquote { border-left: 4px solid #4b5563; padding-left: 1rem; color: #9ca3af; margin: 0.75rem 0; }
    </style>
  </head>
  <body class="bg-slate-950 text-slate-100">
    <div id="root"></div>

    <script type="module">
      import React, { useEffect, useMemo, useState, useCallback } from "https://esm.sh/react@18.2.0";
      import { createRoot } from "https://esm.sh/react-dom@18.2.0/client";
      import { ethers } from "https://esm.sh/ethers@6.9.0";
      import { 
        Calculator, Upload, ListChecks, Hash, Shield, CheckCircle2, HelpCircle, 
        BookOpen, ExternalLink, ChevronDown, ChevronUp
      } from "https://esm.sh/lucide-react@0.323.0";
      import { marked } from "https://esm.sh/marked@9.1.2";

      marked.setOptions({ gfm: true, breaks: true });

      const ADMIN_QS_KEY = "admin";
      const ADMIN_TRUE_VALUES = ["1", "true", "yes"];
      function detectAdminFlag() {
        if (typeof window === "undefined") return false;
        try {
          const params = new URLSearchParams(window.location.search);
          const qs = params.get(ADMIN_QS_KEY);
          if (qs && ADMIN_TRUE_VALUES.includes(qs.toLowerCase())) {
            window.localStorage?.setItem("liqpass.admin", "1");
            return true;
          }
          if (qs === "0" || qs === "false") {
            window.localStorage?.removeItem("liqpass.admin");
            return false;
          }
        } catch (_) {}
        try {
          const stored = window.localStorage?.getItem("liqpass.admin");
          return stored === "1";
        } catch (_) {
          return false;
        }
      }
      const ADMIN_ENABLED = detectAdminFlag();

      /* -------------------- 本地化核心 -------------------- */
      const SUPPORTED_LOCALES = ["zh-CN", "en-US"];
      const LANGUAGE_LABELS = { "zh-CN": "中", "en-US": "EN" };

      function formatMessage(template, vars = {}) {
        if (typeof template !== "string") return "";
        return template.replace(/\{(\w+)\}/g, (_, key) => (key in vars ? String(vars[key]) : `{${key}}`));
      }

      const LocaleContext = React.createContext({
        locale: "zh-CN",
        setLocale: () => {},
        tr: (zh, en, vars) => formatMessage(zh, vars)
      });

      function useLocale() { return React.useContext(LocaleContext); }
      function detectInitialLocale() {
        if (typeof window !== "undefined") {
          try {
            const stored = window.localStorage?.getItem("liqpass.locale");
            if (stored && SUPPORTED_LOCALES.includes(stored)) return stored;
          } catch (_) {}
          if (typeof navigator !== "undefined") {
            const navLang = (navigator.language || navigator.userLanguage || "").toLowerCase();
            if (navLang.startsWith("en")) return "en-US";
          }
        }
        return "zh-CN";
      }

      /* -------------------- 多语言字典 -------------------- */
      const DICT = {
        zh: {
          brand: "LiqPass",
          chain: "Base 主网",
          tab_ux: "OKX 合约险 · UX",
          tab_quote: "报价（P/L→保费/赔付）",
          tab_claim: "爆仓证据上传",
          tab_attest: "证明封装",
          tab_status: "状态追踪",
          tab_appeal: "人工申诉",
          tab_help: "帮助文档",
          hero_title: "输入 P / L 出报价 → 上传爆仓证据 → 自动生成证明包 → 查看状态",
          hero_sub: "仅围绕 本金 / 杠杆 / 保费 / 赔付额；自动生成 proof.json 并随申赔提交。",
          pill_base: "Base 主网",
          pill_okx: "OKX · 首发",

          quote_title: "报价计算（仅演示）",
          principal: "本金 (USDT)",
          leverage: "杠杆 (×，≤100)",
          btn_get_quote: "生成报价",
          premium: "保费",
          payout: "赔付额",
          premium_ratio: "保费比例",
          payout_ratio: "赔付比例",
          quote_id: "报价编号",
          valid_until: "有效期（10 分钟）",
          pricing_ver: "价格版本",
          err_range: "本金需在 50–500 USDT，杠杆需在 1–100。",

          claim_title: "上传爆仓证据（OKX / JSON）",
          choose_sample: "选择示例",
          sample_none: "不使用示例",
          sample_okx_liq: "示例：OKX 爆仓（LINK-USDT 强平）",
          sample_binance_liq: "示例：币安爆仓（BTCUSDT 强平）",
          or_paste: "或粘贴 JSON 文本",
          json_input_label: "JSON 凭证（可选）",
          appeal_title: "申诉通道",
          appeal_intro: "自动校验未通过时，可提交申诉以人工复核。",
          appeal_reason_label: "申诉说明",
          appeal_reason_placeholder: "请描述强平细节、截图链接等补充信息。",
          appeal_contact_label: "联系邮箱或 Telegram（可选）",
          appeal_contact_placeholder: "例如：user@example.com / @handle",
          btn_submit_appeal: "提交申诉",
          appeal_submitted: "申诉已接收，我们将尽快处理。",
          appeal_require_reason: "请填写申诉说明后再提交。",
          appeal_reference: "申诉编号",
          appeal_module_title: "人工申诉通道",
          appeal_module_intro: "如对自动校验结果有疑问，请在此提交补充说明与截图。",
          appeal_upload_label: "上传截图",
          appeal_upload_helper: "支持 PNG、JPG、WEBP，单个文件 ≤ 5 MB。",
          appeal_upload_selected: "已选择",
          appeal_upload_remove: "移除截图",
          appeal_preview_label: "截图预览",
          appeal_file_too_large: "截图文件需小于 5 MB，请压缩后再试。",
          appeal_file_error: "截图读取失败，请重试。",
          btn_validate: "校验证据",
          validation_result: "校验结果",
          order_id_label: "订单号",
          order_id_placeholder: "请输入与交易所一致的订单号",
          pass: "通过",
          fail: "失败",
          claim_highlights: [
            { title: "申诉", desc: "触发仲裁或人工复核；与链上记录保持一致，确保申诉闭环。" },
            { title: "订单号", desc: "请填写交易所原始订单号，便于匹配 Merkle proof 与订单指纹。" },
            { title: "凭证材料", desc: "上传 CSV/JSON 或截图提取的最小字段，支持本地验证器重新补交。" },
          ],

          attest_title: "证明封装（生成 Root & 模拟 Tx）",
          btn_build_root: "生成 Root",
          btn_attest: "提交存证 (Mock)",
          root: "Merkle Root (演示)",
          txhash: "交易哈希 (模拟)",

          status_title: "最近申赔 / 存证（演示数据）",
          steps_title: "用户路径（UX Flow）",
          s1: { title: "报价", body: "输入本金与杠杆，计算保费/赔付额，生成 quote_id。" },
          s2: { title: "申赔", body: "出现强平/ADL 时，上传样例或 JSON，自动校验关键信息。" },
          s3: { title: "证明", body: "对关键字段做哈希生成 root，封装 proof.json 并可选上传链上（演示）。" },
          s4: { title: "状态", body: "公开最近 N 笔 root/tx，评审可一键核对。" },
          disclaimer: "免责声明：本组件为演示 UX，不构成投资建议；样例数据与上链交易均为模拟。",
          
          // 帮助文档相关
          help_title: "帮助文档",
          project_overview: "项目简介",
          why_exchanges: "为什么选择这些交易所",
          why_connect: "为什么用户愿意绑定交易所信息",
          workflow: "产品与理赔流程",
          data_privacy: "数据与隐私",
          pricing: "定价与风控说明",
          contact: "联系方式",
          expand_all: "展开全部",
          collapse_all: "收起全部",
          toggle_section: "切换章节"
        },
        en: {
          brand: "LiqPass",
          chain: "Base Mainnet",
          tab_ux: "OKX Insurance · UX",
          tab_quote: "Quote (P/L → Premium/Payout)",
          tab_claim: "Liquidation Evidence",
          tab_attest: "Proof Builder",
          tab_status: "Status",
          tab_appeal: "Appeal",
          tab_help: "Help Documentation",
          hero_title: "Enter P/L → Upload Liq Evidence → Auto proof bundle → Track status",
          hero_sub: "Only principal / leverage / premium / payout. proof.json is generated automatically for claims.",
          pill_base: "Base Mainnet",
          pill_okx: "OKX · First Launch",

          quote_title: "Quote (Demo)",
          principal: "Principal (USDT)",
          leverage: "Leverage (×, ≤100)",
          btn_get_quote: "Get Quote",
          premium: "Premium",
          payout: "Payout",
          premium_ratio: "Premium Ratio",
          payout_ratio: "Payout Ratio",
          quote_id: "Quote ID",
          valid_until: "Valid Until (10 min)",
          pricing_ver: "Pricing Version",
          err_range: "Principal must be 50–500 USDT and leverage 1–100.",

          claim_title: "Upload Liquidation Evidence (OKX / JSON)",
          choose_sample: "Choose Sample",
          sample_none: "No Sample",
          sample_okx_liq: "Sample: OKX Liquidation (LINK-USDT)",
          sample_binance_liq: "Sample: Binance Liquidation (BTCUSDT)",
          or_paste: "or paste JSON text",
          json_input_label: "JSON Evidence (optional)",
          appeal_title: "Appeal Channel",
          appeal_intro: "Auto validation failed. Provide details for manual review.",
          appeal_reason_label: "Appeal Notes",
          appeal_reason_placeholder: "Describe liquidation details, links to proofs, etc.",
          appeal_contact_label: "Contact Email or Telegram (optional)",
          appeal_contact_placeholder: "e.g. user@example.com / @handle",
          btn_submit_appeal: "Submit Appeal",
          appeal_submitted: "Appeal received. We'll review soon.",
          appeal_require_reason: "Please add appeal notes before submitting.",
          appeal_reference: "Appeal Reference",
          appeal_module_title: "Manual Appeal Desk",
          appeal_module_intro: "If auto validation fails, add context and screenshots here for manual review.",
          appeal_upload_label: "Upload Screenshot",
          appeal_upload_helper: "Supports PNG, JPG, WEBP up to 5 MB.",
          appeal_upload_selected: "Selected",
          appeal_upload_remove: "Remove Screenshot",
          appeal_preview_label: "Screenshot Preview",
          appeal_file_too_large: "Screenshot must be smaller than 5 MB. Please compress and retry.",
          appeal_file_error: "Failed to read screenshot. Please try again.",
          btn_validate: "Validate Evidence",
          validation_result: "Validation Result",
          order_id_label: "Order ID",
          order_id_placeholder: "Enter the exact exchange order ID",
          pass: "PASS",
          fail: "FAIL",
          claim_highlights: [
            { title: "Appeal", desc: "Trigger arbitration/manual review to close the loop with on-chain records." },
            { title: "Order ID", desc: "Provide original exchange order ID to match Merkle proof & trade fingerprint." },
            { title: "Evidence", desc: "Upload CSV/JSON or minimal fields; local validator may resubmit." },
          ],

          attest_title: "Proof Builder (Build Root & Mock Tx)",
          btn_build_root: "Build Root",
          btn_attest: "Submit Attestation (Mock)",
          root: "Merkle Root (Demo)",
          txhash: "Tx Hash (Mock)",

          status_title: "Recent Claims / Attestations (Demo)",
          steps_title: "User Flow",
          s1: { title: "Quote", body: "Enter principal & leverage → compute premium/payout & quote_id." },
          s2: { title: "Claim", body: "When liquidation/ADL occurs, upload sample or JSON for auto-validation." },
          s3: { title: "Proof", body: "Hash key fields to form a root, wrap proof.json, optionally record on-chain (mock)." },
          s4: { title: "Status", body: "Expose latest root/tx for auditability." },
          disclaimer: "Disclaimer: Demo UX only; samples & on-chain tx are mocked with no real payout.",
          
          // Help documentation
          help_title: "Help Documentation",
          project_overview: "Project Overview",
          why_exchanges: "Why These Exchanges",
          why_connect: "Why Users Connect Exchange Data",
          workflow: "Product & Claim Workflow",
          data_privacy: "Data & Privacy",
          pricing: "Pricing & Risk Control",
          contact: "Contact",
          expand_all: "Expand All",
          collapse_all: "Collapse All",
          toggle_section: "Toggle Section"
        },
      };

      /* -------------------- 示例数据 -------------------- */
      const SAMPLE_OKX_LIQ = {
        exchange: "OKX",
        pair: "LINK-USDT-SWAP",
        event: "LIQUIDATION",
        side: "LONG",
        quantity: 176,
        price: 13.516,
        timestamp: "2024-05-02T13:30:50Z",
      };
      const SAMPLE_BINANCE_LIQ = {
        exchange: "BINANCE",
        pair: "BTCUSDT-PERP",
        event: "LIQUIDATION",
        side: "LONG",
        quantity: 3,
        price: 61000.5,
        timestamp: "2024-05-02T13:31:12Z",
      };

      /* -------------------- 工具函数 -------------------- */
      function classNames(...a) { return a.filter(Boolean).join(" "); }
      async function sha256Hex(text) {
        const enc = new TextEncoder();
        const data = enc.encode(text);
        const digest = await crypto.subtle.digest("SHA-256", data);
        return [...new Uint8Array(digest)].map(b=>b.toString(16).padStart(2,"0")).join("");
      }
      const QUOTE_TTL_MIN = 10;
      const LEVERAGE_MAX = 100;
      const MAX_APPEAL_FILE_SIZE = 5 * 1024 * 1024;
      function calcPremium(principal, leverage) {
        const baseRatio = 0.05 + (leverage - 20) * 0.001 + (principal / 500) * 0.02;
        const premiumRatio = Math.min(0.15, baseRatio);
        return { premium: +(premiumRatio * principal).toFixed(2), premiumRatio: +premiumRatio.toFixed(4) };
      }
      function calcPayoutRatio(principal, leverage) {
        const baseRatio = 0.25 + (leverage - 50) * 0.005 - (principal / 500) * 0.1;
        return Math.min(0.5, Math.max(0.1, baseRatio));
      }
      function calcPayout(principal, leverage) {
        const ratio = calcPayoutRatio(principal, leverage);
        return { payout: +(ratio * principal).toFixed(2), payoutRatio: +ratio.toFixed(4) };
      }
      function copyToClipboard(text) {
        if (typeof navigator !== "undefined" && navigator.clipboard) {
          navigator.clipboard.writeText(text).catch(err => console.error('Copy failed:', err));
        }
      }

      /* -------------------- 主要功能组件 -------------------- */
      function PLFlow() {
        const localeContext = useLocale();
        const locale = localeContext.locale;
        const langKey = locale === "en-US" ? "en" : "zh";
        const t = DICT[langKey];
        const [active, setActive] = useState("quote");

        /* -------------------- 状态管理 -------------------- */
        const [principal, setPrincipal] = useState(500);
        const [leverage, setLeverage] = useState(10);
        const [quote, setQuote] = useState(null);
        const [quoteErr, setQuoteErr] = useState("");
        const [sample, setSample] = useState("none");
        const [jsonText, setJsonText] = useState("");
        const [claimRes, setClaimRes] = useState(null);
        const [orderId, setOrderId] = useState("");
        const [appealNote, setAppealNote] = useState("");
        const [appealContact, setAppealContact] = useState("");
        const [appealStatus, setAppealStatus] = useState("");
        const [appealTicket, setAppealTicket] = useState("");
        const [manualAppealReason, setManualAppealReason] = useState("");
        const [manualAppealContact, setManualAppealContact] = useState("");
        const [manualAppealStatus, setManualAppealStatus] = useState("");
        const [manualAppealTicket, setManualAppealTicket] = useState("");
        const [manualAppealScreenshotName, setManualAppealScreenshotName] = useState("");
        const [manualAppealScreenshotData, setManualAppealScreenshotData] = useState("");

        const [root, setRoot] = useState("");
        const [tx, setTx] = useState("");
        const [status, setStatus] = useState([
          {
            when: "2025-10-11 05:30:57 UTC",
            root: "0xb815fb0e7b1a244c84e366fe6203adb963122ef7379d7ad9b2411240639900ff",
            tx: "0x27fd052c9450674457ad5f7f560fc2ea8fbe78534653b70f409a9d633720853e",
            order: "wjz5788.com demo"
          }
        ]);
        const [attachedProof, setAttachedProof] = useState(() => {
          if (typeof window === "undefined") return null;
          try {
            const raw = window.localStorage?.getItem("liqpass.latestProof");
            return raw ? JSON.parse(raw) : null;
          } catch (_) {
            return null;
          }
        });
        const isAdmin = ADMIN_ENABLED;

        /* -------------------- 副作用 -------------------- */
        useEffect(() => {
          if (!isAdmin && active === "attest") {
            setActive("quote");
          }
        }, [isAdmin, active]);
        useEffect(() => {
          if (typeof window === "undefined") return;
          const sync = () => {
            try {
              const raw = window.localStorage?.getItem("liqpass.latestProof");
              setAttachedProof(raw ? JSON.parse(raw) : null);
            } catch (_) {}
          };
          sync();
          const onUpdate = () => sync();
          window.addEventListener("storage", onUpdate);
          window.addEventListener("liqpass:proof-updated", onUpdate);
          return () => {
            window.removeEventListener("storage", onUpdate);
            window.removeEventListener("liqpass:proof-updated", onUpdate);
          };
        }, []);

        const PRICING_VERSION = "pl-formula-v1";
        useEffect(() => {
          if (manualAppealStatus === "missing" && manualAppealReason.trim()) {
            setManualAppealStatus("");
          }
        }, [manualAppealStatus, manualAppealReason]);

        /* -------------------- 核心功能处理函数 -------------------- */
        const computeQuote = useCallback((P, L) => {
          const { premium, premiumRatio } = calcPremium(P, L);
          const { payout, payoutRatio } = calcPayout(P, L);
          const quoteId = `Q-${Date.now()}-${Math.floor(Math.random() * 1000)}`;
          const validTs = Date.now() + QUOTE_TTL_MIN * 60 * 1000;
          const valid = new Date(validTs).toLocaleString();
          return { payout, premium, premiumRatio, payoutRatio, quoteId, valid, validTs, pricingVersion: PRICING_VERSION };
        }, []);

        const handleGetQuote = useCallback(() => {
          const P = Number(principal), L = Number(leverage);
          if (!Number.isFinite(P) || !Number.isFinite(L) || P < 50 || P > 500 || L < 1 || L > LEVERAGE_MAX) {
            setQuote(null);
            setQuoteErr(t.err_range);
            return;
          }
          setQuoteErr("");
          const q = computeQuote(P, L);
          setQuote(q);
        }, [principal, leverage, computeQuote, t.err_range]);

        const currentOrderRef = orderId || quote?.quoteId || "";
        const proofMatchState = attachedProof
          ? (!attachedProof.orderId || !currentOrderRef || attachedProof.orderId === currentOrderRef ? "match" : "mismatch")
          : "none";

        const buildEvidenceSummary = useCallback(() => {
          const evidence =
            sample === "okx_liq" ? SAMPLE_OKX_LIQ : sample === "binance_liq" ? SAMPLE_BINANCE_LIQ
              : (() => { try { return JSON.parse(jsonText || "{}"); } catch { return {}; } })();
          const requestedOrderId = currentOrderRef || `DEMO-${Date.now()}`;
          const summary = {
            order_id: requestedOrderId,
            principal: Number(principal || 0),
            leverage: Number(leverage || 0),
            payout: quote?.payout ?? calcPayout(Number(principal||0), Number(leverage||0)).payout,
            premium: quote?.premium ?? calcPremium(Number(principal||0), Number(leverage||0)).premium,
            pricing_version: PRICING_VERSION,
            evidence,
          };
          if (attachedProof) {
            summary.proof_bundle = attachedProof;
          }
          return summary;
        }, [sample, jsonText, quote, principal, leverage, attachedProof, currentOrderRef]);

        const handleValidate = useCallback(async () => {
          const summary = buildEvidenceSummary();
          const input = JSON.stringify(summary);
          const ok = summary.evidence?.event === "LIQUIDATION";
          const proofBundle = attachedProof && (!attachedProof.orderId || attachedProof.orderId === summary.order_id) ? attachedProof : null;
          const proofRoot = proofBundle?.root ?? await sha256Hex(input);
          setClaimRes({ res: { ok, proof: proofRoot, proofBundle }, summary });
          setRoot(proofRoot);
          setAppealNote("");
          setAppealContact("");
          setAppealStatus("");
          setAppealTicket("");
        }, [buildEvidenceSummary, attachedProof]);

        const handleBuildRoot = useCallback(async () => {
          if (attachedProof?.root) {
            setRoot(attachedProof.root);
            return;
          }
          if (claimRes?.res && !claimRes.res.ok) return;
          if (!claimRes) {
            const summary = buildEvidenceSummary();
            const proof = await sha256Hex(JSON.stringify(summary));
            setClaimRes({ res: { ok: true, proof }, summary });
            setRoot(proof);
            return;
          }
          const leaf = JSON.stringify(claimRes.summary);
          const newRoot = await sha256Hex(leaf + Date.now());
          setRoot(newRoot);
        }, [attachedProof, claimRes, buildEvidenceSummary]);

        const handleAttest = useCallback(async () => {
          if (claimRes?.res && !claimRes.res.ok) return;
          if (!root) return;
          const mockTx = await sha256Hex(root + Math.random());
          setTx(mockTx);
          setStatus((prev) => [
            { when: new Date().toISOString(), root, tx: mockTx, order: claimRes?.summary?.order_id ?? "demo-order" },
            ...prev.slice(0, 4),
          ]);
        }, [root, claimRes]);
        
        const copyStatusValue = useCallback((value) => {
          if (!value) return;
          copyToClipboard(value);
        }, []);

        const submitAppeal = useCallback(async ({
          reason,
          contact,
          summary,
          screenshotData,
          screenshotName,
          setStatus,
          setTicket,
        } = {}) => {
          const note = (reason ?? "").trim();
          const contactInfo = (contact ?? "").trim();
          const updateStatus = setStatus ?? setAppealStatus;
          const updateTicket = setTicket ?? setAppealTicket;
          if (!note) {
            updateStatus("missing");
            updateTicket("");
            return;
          }
          updateStatus("submitting");
          const baseSummary = summary ?? buildEvidenceSummary();
          const payload = {
            ...baseSummary,
            appeal: {
              reason: note,
              contact: contactInfo || undefined,
              submitted_at: new Date().toISOString(),
              screenshot_name: screenshotName || undefined,
              screenshot_data_url: screenshotData || undefined,
            }
          };
          const ticket = await sha256Hex(JSON.stringify(payload));
          updateTicket(ticket);
          updateStatus("submitted");
        }, [buildEvidenceSummary]);

        const handleSubmitAppeal = useCallback(async () => {
          if (!claimRes || claimRes.res.ok) return;
          await submitAppeal({
            reason: appealNote,
            contact: appealContact,
            summary: claimRes.summary,
            setStatus: setAppealStatus,
            setTicket: setAppealTicket,
          });
        }, [claimRes, appealNote, appealContact, submitAppeal]);

        const handleManualAppealFile = useCallback((file) => {
          setManualAppealTicket("");
          if (!file) {
            setManualAppealScreenshotName("");
            setManualAppealScreenshotData("");
            setManualAppealStatus("");
            return;
          }
          if (file.size > MAX_APPEAL_FILE_SIZE) {
            setManualAppealScreenshotName("");
            setManualAppealScreenshotData("");
            setManualAppealStatus("file-too-large");
            return;
          }
          const reader = new FileReader();
          reader.onload = () => {
            if (typeof reader.result === "string") {
              setManualAppealScreenshotData(reader.result);
              setManualAppealScreenshotName(file.name);
              setManualAppealStatus("");
            } else {
              setManualAppealScreenshotData("");
              setManualAppealScreenshotName("");
              setManualAppealStatus("file-error");
            }
          };
          reader.onerror = () => {
            setManualAppealScreenshotData("");
            setManualAppealScreenshotName("");
            setManualAppealStatus("file-error");
          };
          reader.readAsDataURL(file);
        }, []);

        const handleManualAppealRemoveFile = useCallback(() => {
          setManualAppealScreenshotName("");
          setManualAppealScreenshotData("");
          setManualAppealStatus("");
          setManualAppealTicket("");
        }, []);

        const handleManualAppealSubmit = useCallback(async () => {
          if (manualAppealStatus === "submitting" || manualAppealStatus === "file-too-large" || manualAppealStatus === "file-error") return;
          await submitAppeal({
            reason: manualAppealReason,
            contact: manualAppealContact,
            summary: buildEvidenceSummary(),
            screenshotData: manualAppealScreenshotData,
            screenshotName: manualAppealScreenshotName,
            setStatus: setManualAppealStatus,
            setTicket: setManualAppealTicket,
          });
        }, [
          manualAppealStatus,
          manualAppealReason,
          manualAppealContact,
          manualAppealScreenshotData,
          manualAppealScreenshotName,
          submitAppeal,
          buildEvidenceSummary
        ]);

        /* -------------------- UI组件 -------------------- */
        const Tab = ({ id, label, icon: Icon }) => (
          React.createElement("button", {
              onClick: () => setActive(id),
              className: classNames(
                "inline-flex items-center gap-2 px-4 py-2 rounded-full text-sm",
                active === id ? "bg-white/90 text-slate-900" : "bg-white/10 text-white hover:bg-white/20"
              )
            },
            Icon ? React.createElement(Icon, { size: 16 }) : null,
            " ", label
          )
        );

        const Stat = ({ label, value }) => (
          React.createElement("div", { className: "flex flex-col p-4 rounded-2xl bg-white/5 border border-white/10" },
            React.createElement("div", { className: "text-xs text-white/60" }, label),
            React.createElement("div", { className: "text-lg font-semibold mt-1" }, value)
          )
        );

        const StepCard = ({ idx, title, body, icon: Icon }) => (
          React.createElement("div", { className: "p-5 rounded-2xl bg-white/5 border border-white/10 h-full" },
            React.createElement("div", { className: "flex items-center gap-2 text-white/80 text-xs tracking-wide" },
              React.createElement("span", { className: "px-2 py-0.5 rounded-full bg-white/10" }, `STEP ${idx}`)
            ),
            React.createElement("div", { className: "flex items-center gap-2 mt-3" },
              Icon ? React.createElement(Icon, { size: 18, className: "text-white/80" }) : null,
              React.createElement("div", { className: "font-semibold" }, title)
            ),
            React.createElement("div", { className: "text-sm text-white/70 mt-2 leading-relaxed" }, body)
          )
        );

        const highlightIcons = [Shield, CheckCircle2, HelpCircle];

        const renderAppealFeedback = (status, ticket) => {
          if (!status && !ticket) return null;
          if (status === "missing") {
            return React.createElement("p", { className: "text-sm text-rose-300" }, t.appeal_require_reason);
          }
          if (status === "submitting") {
            return React.createElement("p", { className: "text-sm text-white/70" }, locale === "en-US" ? "Submitting..." : "提交中...");
          }
          if (status === "submitted") {
            return React.createElement("div", { className: "space-y-1 text-sm text-emerald-300" },
              React.createElement("p", null, t.appeal_submitted),
              ticket ? React.createElement("p", { className: "text-xs text-emerald-200/80 break-all" }, `${t.appeal_reference}：${ticket}`) : null
            );
          }
          if (status === "file-too-large") {
            return React.createElement("p", { className: "text-sm text-rose-300" }, t.appeal_file_too_large);
          }
          if (status === "file-error") {
            return React.createElement("p", { className: "text-sm text-rose-300" }, t.appeal_file_error);
          }
          return ticket ? React.createElement("p", { className: "text-xs text-white/60 break-all" }, `${t.appeal_reference}：${ticket}`) : null;
        };

        /* -------------------- 页面视图 -------------------- */
        const quoteView = React.createElement("div", { className: "space-y-6" },
          React.createElement("div", { className: "grid gap-6 lg:grid-cols-[1.2fr,0.8fr]" },
            React.createElement("div", { className: "rounded-3xl border border-white/10 bg-white/5 p-6 space-y-4" },
              React.createElement("h3", { className: "text-lg font-semibold" }, t.quote_title),
              React.createElement("div", { className: "grid gap-4 sm:grid-cols-2" },
                React.createElement("label", { className: "flex flex-col gap-2 text-sm text-white/70" },
                  React.createElement("span", null, t.principal),
                  React.createElement("input", {
                    className: "rounded-xl border border-white/10 bg-black/30 px-3 py-2 text-white focus:border-indigo-400 focus:outline-none",
                    type: "number",
                    min: "0",
                    value: principal,
                    onChange: (e) => setPrincipal(e.target.value)
                  })
                ),
                React.createElement("label", { className: "flex flex-col gap-2 text-sm text-white/70" },
                  React.createElement("span", null, t.leverage),
                  React.createElement("input", {
                    className: "rounded-xl border border-white/10 bg-black/30 px-3 py-2 text-white focus:border-indigo-400 focus:outline-none",
                    type: "number",
                    min: "1",
                    max: String(LEVERAGE_MAX),
                    value: leverage,
                    onChange: (e) => setLeverage(e.target.value)
                  })
                )
              ),
              React.createElement("div", { className: "flex flex-wrap items-center gap-3" },
                React.createElement("button", {
                  type: "button",
                  onClick: handleGetQuote,
                  className: "rounded-full bg-indigo-500 px-5 py-2 text-sm font-medium text-white shadow-lg shadow-indigo-700/30 transition hover:bg-indigo-400"
                }, t.btn_get_quote),
                React.createElement("span", { className: "text-xs text-white/60" }, `${t.valid_until}：${QUOTE_TTL_MIN} ${locale === "en-US" ? "minutes" : "分钟"}`)
              ),
              quoteErr ? React.createElement("p", { className: "text-sm text-rose-300" }, quoteErr) : null,
              quote ? React.createElement("div", { className: "space-y-1 text-xs text-white/60" },
                React.createElement("p", null, `${t.quote_id}：${quote.quoteId}`),
                React.createElement("p", null, `${t.valid_until}：${quote.valid}`),
                React.createElement("p", null, `${t.pricing_ver}：${quote.pricingVersion}`)
              ) : null
            ),
            React.createElement("div", { className: "space-y-4" },
                React.createElement("p", null, "当前已完成对接的交易所包括：OKX、Binance（币安）、Bybit。选择这些交易所的原因是："),
                React.createElement("ul", null,
                  React.createElement("li", null, "用户基数大，衍生品交易量全球领先"),
                  React.createElement("li", null, "提供完整的 API 和 Webhook，便于数据同步"),
                  React.createElement("li", null, "强平事件结构化程度高，便于自动校验"),
                  React.createElement("li", null, "具备完善的 KYC 体系，有效防止欺诈"),
                  React.createElement("li", null, "支持 USDT 结算，与保险产品设计一致")
                ),
                React.createElement("p", null, "Currently integrated exchanges include: OKX, Binance, and Bybit. These exchanges were selected because:"),
                React.createElement("ul", null,
                  React.createElement("li", null, "Large user base and leading global derivatives trading volume"),
                  React.createElement("li", null, "Comprehensive API and Webhook support for data synchronization"),
                  React.createElement("li", null, "Highly structured liquidation event data for automated validation"),
                  React.createElement("li", null, "Robust KYC systems to prevent fraud"),
                  React.createElement("li", null, "USDT settlement support, aligned with insurance product design")
                )
              )
            )
          ),
          
          React.createElement(HelpSection, { title: t.why_connect, id: "why-connect" },
            React.createElement("div", { className: "space-y-4" },
              React.createElement("p", null, "用户愿意绑定交易所信息的理由："),
              React.createElement("ul", null,
                React.createElement("li", null, "高杠杆交易的风险对冲：" + (locale === "en-US" ? "For high-leverage trading risk hedging" : "避免爆仓后血本无归，保留大部分本金"))),
                React.createElement("li", null, "简化理赔流程：" + (locale === "en-US" ? "Simplified claim process" : "自动检测爆仓，无需手动提交"))),
                React.createElement("li", null, "保障机制透明：" + (locale === "en-US" ? "Transparent protection mechanism" : "链上可验证的理赔规则"))),
                React.createElement("li", null, "交易体验提升：" + (locale === "en-US" ? "Improved trading experience" : "专注交易策略，不必过度担忧市场波动")))
              )
            )
          ),
          
          React.createElement(HelpSection, { title: t.workflow, id: "workflow" },
            React.createElement("div", { className: "space-y-4" },
              React.createElement("p", null, "产品与理赔流程："),
              React.createElement("ol", null,
                React.createElement("li", null, "**报价**：用户输入本金和杠杆，系统自动计算保费和赔付额"),
                React.createElement("li", null, "**投保**：用户支付保费，完成投保"),
                React.createElement("li", null, "**交易**：用户在绑定的交易所进行杠杆交易"),
                React.createElement("li", null, "**触发**：当发生强平事件时，系统自动检测并触发理赔流程"),
                React.createElement("li", null, "**校验**：系统自动校验强平证据，确保符合理赔条件"),
                React.createElement("li", null, "**赔付**：校验通过后，系统自动将赔付额打入用户钱包"),
                React.createElement("li", null, "**申诉**：若校验未通过，用户可提交申诉进行人工复核")
              ),
              React.createElement("p", null, "Product and Claim Workflow:"),
              React.createElement("ol", null,
                React.createElement("li", null, "**Quote**: User inputs principal and leverage, system calculates premium and payout automatically"),
                React.createElement("li", null, "**Insurance Purchase**: User pays premium to complete insurance purchase"),
                React.createElement("li", null, "**Trading**: User conducts leveraged trading on connected exchange"),
                React.createElement("li", null, "**Trigger**: System automatically detects liquidation events and initiates claim process"),
                React.createElement("li", null, "**Validation**: System automatically validates liquidation evidence to ensure claim eligibility"),
                React.createElement("li", null, "**Payout**: Upon validation success, system automatically transfers payout to user wallet"),
                React.createElement("li", null, "**Appeal**: If validation fails, user can submit appeal for manual review")
              )
            )
          ),
          
          React.createElement(HelpSection, { title: t.data_privacy, id: "privacy" },
            React.createElement("div", { className: "space-y-4" },
              React.createElement("p", null, "数据与隐私保护："),
              React.createElement("ul", null,
                React.createElement("li", null, "**本地加密存储**：API 密钥仅本地加密存储，不上传到服务器"),
                React.createElement("li", null, "**只读权限**：仅请求交易历史和账户信息的只读权限，无法操作资金"),
                React.createElement("li", null, "**数据最小化**：仅收集必要的交易和账户信息，不收集个人身份信息"),
                React.createElement("li", null, "**安全传输**：所有数据传输均采用 TLS 加密"),
                React.createElement("li", null, "**数据匿名化**：链上存储的理赔记录经过哈希处理，保护用户隐私")
              ),
              React.createElement("p", null, "Data and Privacy Protection:"),
              React.createElement("ul", null,
                React.createElement("li", null, "**Local Encrypted Storage**: API keys are encrypted and stored locally, never uploaded to servers"),
                React.createElement("li", null, "**Read-Only Permissions**: Only request read-only access to trading history and account information, cannot operate funds"),
                React.createElement("li", null, "**Data Minimization**: Only collect necessary trading and account information, not personal identity information"),
                React.createElement("li", null, "**Secure Transmission**: All data transmission uses TLS encryption"),
                React.createElement("li", null, "**Data Anonymization**: On-chain claim records are hashed to protect user privacy")
              )
            )
          ),
          
          React.createElement(HelpSection, { title: t.pricing, id: "pricing" },
            React.createElement("div", { className: "space-y-4" },
              React.createElement("p", null, "定价与风控说明："),
              React.createElement("ul", null,
                React.createElement("li", null, "**定价模型**：基于本金、杠杆率、历史波动率的动态定价模型"),
                React.createElement("li", null, "**保费构成**：基础保费 + 杠杆风险溢价 + 市场波动溢价"),
                React.createElement("li", null, "**赔付比例**：根据本金和杠杆率，赔付比例在 10%-50% 之间浮动"),
                React.createElement("li", null, "**风险控制**：限制最大杠杆率（≤100倍），设置单用户最高保额"),
                React.createElement("li", null, "**资金池管理**：通过再保险、对冲交易等方式管理资金池风险")
              ),
              React.createElement("p", null, "Pricing and Risk Control:"),
              React.createElement("ul", null,
                React.createElement("li", null, "**Pricing Model**: Dynamic pricing based on principal, leverage ratio, and historical volatility"),
                React.createElement("li", null, "**Premium Structure**: Base premium + leverage risk premium + market volatility premium"),
                React.createElement("li", null, "**Payout Ratio**: Floating between 10-50% based on principal and leverage ratio"),
                React.createElement("li", null, "**Risk Control**: Maximum leverage limit (≤100x), single-user coverage cap"),
                React.createElement("li", null, "**Pool Management**: Managing fund pool risks through reinsurance and hedging transactions")
              )
            )
          ),
          
          React.createElement(HelpSection, { title: t.contact, id: "contact" },
            React.createElement("div", { className: "space-y-4" },
              React.createElement("p", null, "联系方式："),
              React.createElement("ul", null,
                React.createElement("li", null, "**官网**：", React.createElement("a", { href: "https://wjz5788.com", target: "_blank" }, "https://wjz5788.com")),
                React.createElement("li", null, "**GitHub**：", React.createElement("a", { href: "https://github.com/wjz5788/leverageguard-attestor", target: "_blank" }, "https://github.com/wjz5788/leverageguard-attestor")),
                React.createElement("li", null, "**Base 合约地址**：0x9552b58d323993f84d01e3744f175f47a9462f94")
              ),
              React.createElement("p", null, "Contact Information:"),
              React.createElement("ul", null,
                React.createElement("li", null, "**Website**：", React.createElement("a", { href: "https://wjz5788.com", target: "_blank" }, "https://wjz5788.com")),
                React.createElement("li", null, "**GitHub**：", React.createElement("a", { href: "https://github.com/wjz5788/leverageguard-attestor", target: "_blank" }, "https://github.com/wjz5788/leverageguard-attestor")),
                React.createElement("li", null, "**Base Contract Address**：0x9552b58d323993f84d01e3744f175f47a9462f94")
              )
            )
          )
        );

        /* -------------------- 区块链配置 -------------------- */
        const BASE_CHAIN_ID = "8453";
        const BASE_CHAIN_NAME = "Base Mainnet";
        const ATTESTOR_ADDR = "0x9552b58d323993f84d01e3744f175f47a9462f94";
        const ATTESTOR_ABI = [];

        /* -------------------- 本地化处理 -------------------- */
        const tabItems = [
          { id: "quote", label: t.tab_quote, icon: Calculator },
          { id: "claim", label: t.tab_claim, icon: Upload },
          { id: "appeal", label: t.tab_appeal, icon: HelpCircle },
          { id: "attest", label: t.tab_attest, icon: Hash, adminOnly: true },
          { id: "status", label: t.tab_status, icon: ListChecks },
          { id: "help", label: t.tab_help, icon: BookOpen }
        ].filter(({ adminOnly }) => !adminOnly || isAdmin);

        /* -------------------- 主应用渲染 -------------------- */
        return React.createElement("div", { className: "min-h-screen bg-slate-950 text-slate-100" },
          React.createElement("header", { className: "sticky top-0 z-50 border-b border-white/10 bg-black/30 backdrop-blur-lg" },
            React.createElement("div", { className: "container mx-auto px-4 py-3 flex flex-wrap items-center justify-between gap-2" },
              React.createElement("div", { className: "flex items-center gap-3" },
                React.createElement(Shield, { size: 20 }),
                React.createElement("h1", { className: "text-lg font-bold" }, t.brand),
                React.createElement("div", { className: "hidden sm:flex items-center gap-2" },
                  React.createElement("span", { className: "inline-flex items-center gap-1 rounded-full bg-indigo-500/20 px-2.5 py-0.5 text-xs text-indigo-200" }, t.pill_base),
                  React.createElement("span", { className: "inline-flex items-center gap-1 rounded-full bg-green-500/20 px-2.5 py-0.5 text-xs text-green-200" }, t.pill_okx)
                )
              ),
              React.createElement("div", { className: "flex items-center gap-2" },
                React.createElement("div", { className: "flex gap-1" },
                  ...SUPPORTED_LOCALES.map((loc) =>
                    React.createElement("button", {
                      key: loc,
                      className: classNames(
                        "px-3 py-1.5 rounded-full text-sm",
                        locale === loc
                          ? "bg-white/90 text-slate-900"
                          : "bg-white/10 text-white hover:bg-white/20"
                      ),
                      onClick: () => {
                        if (typeof window !== "undefined") {
                          window.localStorage?.setItem("liqpass.locale", loc);
                          window.location.reload();
                        }
                      }
                    }, LANGUAGE_LABELS[loc])
                  )
                )
              )
            )
          ),
          React.createElement("main", { className: "container mx-auto px-4 py-6 pb-24" },
            React.createElement("section", { className: "mb-10" },
              React.createElement("div", { className: "mb-8 max-w-3xl mx-auto text-center" },
                React.createElement("h2", { className: "mb-2 text-2xl font-bold sm:text-3xl" }, t.hero_title),
                React.createElement("p", { className: "text-sm text-white/70" }, t.hero_sub)
              ),
              React.createElement("div", { className: "mb-8 overflow-x-auto pb-2" },
                React.createElement("div", { className: "flex min-w-max justify-center gap-1.5" },
                  tabItems.map(({ id, label, icon: Icon }) => (
                    React.createElement(Tab, { key: id, id, label, icon: Icon })
                  ))
                )
              ),
              React.createElement("div", { className: "min-h-[200px]" },
                active === "quote" ? quoteView :
                active === "claim" ? claimView :
                active === "appeal" ? appealView :
                active === "attest" ? attestView :
                active === "status" ? statusView :
                active === "help" ? helpView : null
              )
            )
          ),
          React.createElement("footer", { className: "border-t border-white/10 bg-black/30 py-4" },
            React.createElement("div", { className: "container mx-auto px-4 text-center text-xs text-white/50" },
              React.createElement("p", null, t.disclaimer)
            )
          )
        );
      }

      /* -------------------- 主应用渲染 -------------------- */
      function App() {
        const initialLocale = detectInitialLocale() || "zh-CN";
        const [locale, setLocale] = useState(initialLocale);
        const langKey = locale === "en-US" ? "en" : "zh";
        const dict = DICT[langKey];

        const tr = (zh, en, vars) => {
          const template = langKey === "en" ? en : zh;
          return formatMessage(template, vars);
        };

        return React.createElement(LocaleContext.Provider, { value: { locale, setLocale, tr } },
          React.createElement(PLFlow, null)
        );
      }

      const root = createRoot(document.getElementById("root"));
      root.render(React.createElement(App, null));
    </script>
  </body>
</html>
              React.createElement("div", { className: "grid gap-3 sm:grid-cols-2" },
                React.createElement(Stat, { label: t.premium, value: quote ? `${quote.premium.toFixed(2)} USDT` : "—" }),
                React.createElement(Stat, { label: t.payout, value: quote ? `${quote.payout.toFixed(2)} USDT` : "—" }),
                React.createElement(Stat, { label: t.premium_ratio, value: quote ? `${(quote.premiumRatio * 100).toFixed(2)}%` : "—" }),
                React.createElement(Stat, { label: t.payout_ratio, value: quote ? `${(quote.payoutRatio * 100).toFixed(2)}%` : "—" })
              ),
              React.createElement("div", { className: "rounded-3xl border border-white/10 bg-white/5 p-5 text-sm text-white/70 leading-relaxed" }, t.hero_sub)
            )
          )
        );

        const claimView = React.createElement("div", { className: "space-y-6" },
          React.createElement("div", { className: "grid gap-6 lg:grid-cols-[1.2fr,0.8fr]" },
            React.createElement("div", { className: "rounded-3xl border border-white/10 bg-white/5 p-6 space-y-4" },
              React.createElement("h3", { className: "text-lg font-semibold" }, t.claim_title),
              React.createElement("div", { className: "space-y-4 text-sm" },
                React.createElement("label", { className: "block space-y-2 text-sm text-white/70" },
                  React.createElement("span", null, t.choose_sample),
                  React.createElement("select", {
                    className: "w-full rounded-xl border border-white/10 bg-black/30 px-3 py-2 focus:border-indigo-400 focus:outline-none",
                    value: sample,
                    onChange: (e) => setSample(e.target.value)
                  },
                    React.createElement("option", { value: "none" }, t.sample_none),
                    React.createElement("option", { value: "okx_liq" }, t.sample_okx_liq),
                    React.createElement("option", { value: "binance_liq" }, t.sample_binance_liq)
                  )
                ),
                React.createElement("label", { className: "block space-y-2 text-sm text-white/70" },
                  React.createElement("span", null, t.order_id_label),
                  React.createElement("input", {
                    className: "w-full rounded-xl border border-white/10 bg-black/30 px-3 py-2 text-sm text-white focus:border-indigo-400 focus:outline-none",
                    value: orderId,
                    onChange: (e) => setOrderId(e.target.value),
                    placeholder: t.order_id_placeholder
                  })
                )
              ),
              proofMatchState === "match"
                ? React.createElement("div", { className: "rounded-2xl border border-emerald-400/30 bg-emerald-500/10 p-3 text-xs text-emerald-200" },
                    locale === "en-US"
                      ? `Detected proof.json (order ${attachedProof?.orderId || "N/A"}) — it will be auto-attached.`
                      : `已载入 proof.json（订单 ${attachedProof?.orderId || "未填写"}），提交时将自动附带。`
                  )
                : proofMatchState === "mismatch"
                  ? React.createElement("div", { className: "rounded-2xl border border-amber-400/40 bg-amber-500/10 p-3 text-xs text-amber-200" },
                      locale === "en-US"
                        ? `proof.json belongs to order ${attachedProof?.orderId}; current order is ${currentOrderRef || "N/A"}. Please align before submitting.`
                        : `当前 proof.json 关联订单 ${attachedProof?.orderId || "未知"}，与表单订单 ${currentOrderRef || "未填写"} 不一致，请对齐后提交。`
                    )
                  : React.createElement("div", { className: "rounded-2xl border border-white/10 border-dashed bg-black/20 p-3 text-xs text-white/60" },
                      locale === "en-US"
                        ? "No proof.json detected yet. The form will generate a temporary proof automatically."
                        : "尚未检测到 proof.json；提交时将自动生成临时证明。"
                    ),
              React.createElement("div", { className: "flex flex-wrap items-center gap-3" },
                React.createElement("button", {
                  type: "button",
                  onClick: handleValidate,
                  className: "rounded-full bg-emerald-500 px-5 py-2 text-sm font-medium text-white shadow-lg shadow-emerald-700/30 transition hover:bg-emerald-400"
                }, t.btn_validate),
                claimRes && claimRes.res && !claimRes.res.ok
                  ? React.createElement("span", { className: "text-xs text-amber-300" }, locale === "en-US" ? "Auto-check failed — please submit an appeal." : "自动校验未通过，请提交申诉。")
                  : null
              ),
              claimRes ? React.createElement("div", {
                className: classNames(
                  "rounded-2xl border p-4 text-sm",
                  claimRes.res.ok ? "border-emerald-400/60 bg-emerald-400/10 text-emerald-200" : "border-rose-400/60 bg-rose-400/10 text-rose-200"
                )
              },
                React.createElement("div", { className: "font-medium" }, t.validation_result),
                React.createElement("div", { className: "mt-1 text-sm" }, claimRes.res.ok ? t.pass : t.fail),
                React.createElement("div", { className: "mt-2 text-xs text-white/90 break-all" }, `${locale === "en-US" ? "root" : "根"}: ${claimRes.res.proof}`),
                claimRes.res.proofBundle
                  ? React.createElement("div", { className: "mt-2 space-y-1 rounded-xl bg-black/20 p-3 text-xs text-white/70" },
                      React.createElement("p", { className: "break-all" }, `leafHash: ${claimRes.res.proofBundle.leafHash}`),
                      React.createElement("p", { className: "break-all" }, `fileSha256: ${claimRes.res.proofBundle.fileSha256}`),
                      React.createElement("p", null, `${locale === "en-US" ? "proof length" : "Merkle 节点数"}: ${claimRes.res.proofBundle.merkleProof?.length ?? 0}`)
                    )
                  : null,
                React.createElement("div", { className: "mt-2 max-h-48 overflow-auto rounded-xl bg-black/30 p-3 text-xs text-white/80" },
                  React.createElement("pre", { className: "whitespace-pre-wrap break-all" }, JSON.stringify(claimRes.summary, null, 2))
                )
              ) : null
            ),
            React.createElement("div", { className: "space-y-4" },
              React.createElement("div", { className: "rounded-3xl border border-white/10 bg-white/5 p-6 space-y-4" },
                React.createElement("h4", { className: "text-sm font-semibold uppercase tracking-[0.2em] text-white/60" }, locale === "en-US" ? "Claim Highlights" : "申赔要点"),
                t.claim_highlights.map((item, idx) =>
                  React.createElement("div", { key: idx, className: "rounded-2xl border border-white/10 bg-black/30 p-4" },
                    React.createElement("div", { className: "flex items-center gap-3" },
                      React.createElement(highlightIcons[idx % highlightIcons.length], { size: 18, className: "text-white/70" }),
                      React.createElement("div", { className: "font-semibold text-white" }, item.title)
                    ),
                    React.createElement("p", { className: "mt-2 text-sm text-white/70 leading-relaxed" }, item.desc)
                  )
                )
              )
            )
          ),
        );

        const appealView = React.createElement("div", { className: "space-y-6" },
          React.createElement("div", { className: "grid gap-6 lg:grid-cols-2" },
            React.createElement("div", { className: "rounded-3xl border border-white/10 bg-white/5 p-6 space-y-4" },
              React.createElement("h3", { className: "text-lg font-semibold" }, t.appeal_title),
              React.createElement("p", { className: "text-sm text-white/70" }, t.appeal_intro),
              React.createElement("label", { className: "block space-y-2 text-sm text-white/70" },
                React.createElement("span", null, t.appeal_reason_label),
                React.createElement("textarea", {
                  className: "min-h-[120px] w-full rounded-xl border border-white/10 bg-black/30 px-3 py-2 text-sm text-white focus:border-indigo-400 focus:outline-none",
                  value: appealNote,
                  onChange: (e) => setAppealNote(e.target.value),
                  placeholder: t.appeal_reason_placeholder
                })
              ),
              React.createElement("label", { className: "block space-y-2 text-sm text-white/70" },
                React.createElement("span", null, t.appeal_contact_label),
                React.createElement("input", {
                  className: "w-full rounded-xl border border-white/10 bg-black/30 px-3 py-2 text-sm text-white focus:border-indigo-400 focus:outline-none",
                  value: appealContact,
                  onChange: (e) => setAppealContact(e.target.value),
                  placeholder: t.appeal_contact_placeholder
                })
              ),
              React.createElement("div", { className: "flex items-center gap-3" },
                React.createElement("button", {
                  type: "button",
                  onClick: handleSubmitAppeal,
                  className: "rounded-full bg-indigo-500 px-5 py-2 text-sm font-medium text-white shadow-lg shadow-indigo-700/30 transition hover:bg-indigo-400",
                  disabled: appealStatus === "submitting"
                }, t.btn_submit_appeal),
                appealStatus === "submitting"
                  ? React.createElement("span", { className: "text-xs text-white/70" }, locale === "en-US" ? "Submitting..." : "提交中...")
                  : null
              ),
              renderAppealFeedback(appealStatus, appealTicket)
            ),
            React.createElement("div", { className: "rounded-3xl border border-white/10 bg-white/5 p-6 space-y-4" },
              React.createElement("h3", { className: "text-lg font-semibold" }, t.appeal_module_title),
              React.createElement("p", { className: "text-sm text-white/70" }, t.appeal_module_intro),
              React.createElement("label", { className: "block space-y-2 text-sm text-white/70" },
                React.createElement("span", null, t.appeal_reason_label),
                React.createElement("textarea", {
                  className: "min-h-[120px] w-full rounded-xl border border-white/10 bg-black/30 px-3 py-2 text-sm text-white focus:border-indigo-400 focus:outline-none",
                  value: manualAppealReason,
                  onChange: (e) => setManualAppealReason(e.target.value),
                  placeholder: t.appeal_reason_placeholder
                })
              ),
              React.createElement("label", { className: "block space-y-2 text-sm text-white/70" },
                React.createElement("span", null, t.appeal_contact_label),
                React.createElement("input", {
                  className: "w-full rounded-xl border border-white/10 bg-black/30 px-3 py-2 text-sm text-white focus:border-indigo-400 focus:outline-none",
                  value: manualAppealContact,
                  onChange: (e) => setManualAppealContact(e.target.value),
                  placeholder: t.appeal_contact_placeholder
                })
              ),
              React.createElement("label", { className: "block space-y-2 text-sm text-white/70" },
                React.createElement("span", null, t.appeal_upload_label),
                React.createElement("input", {
                  type: "file",
                  accept: "image/png,image/jpeg,image/webp",
                  onChange: (e) => handleManualAppealFile(e.target.files?.[0] ?? null),
                  className: "w-full text-xs text-white/70"
                }),
                React.createElement("p", { className: "text-xs text-white/40" }, t.appeal_upload_helper),
                manualAppealScreenshotName
                  ? React.createElement("div", { className: "flex items-center gap-3 text-xs text-white/60" },
                      React.createElement("span", null, `${t.appeal_upload_selected}：${manualAppealScreenshotName}`),
                      React.createElement("button", { type: "button", className: "rounded-full border border-white/20 px-2 py-1 text-xs text-white hover:border-indigo-300/60", onClick: handleManualAppealRemoveFile }, t.appeal_upload_remove)
                    )
                  : null
              ),
              React.createElement("div", { className: "flex items-center gap-3" },
                React.createElement("button", {
                  type: "button",
                  onClick: handleManualAppealSubmit,
                  className: "rounded-full bg-emerald-500 px-5 py-2 text-sm font-medium text-white shadow-lg shadow-emerald-700/30 transition hover:bg-emerald-400",
                  disabled: manualAppealStatus === "submitting"
                }, t.btn_submit_appeal),
                manualAppealStatus === "submitting"
                  ? React.createElement("span", { className: "text-xs text-white/70" }, locale === "en-US" ? "Submitting..." : "提交中...")
                  : null
              ),
              renderAppealFeedback(manualAppealStatus, manualAppealTicket)
            )
          )
        );

        const attestView = React.createElement("div", { className: "space-y-6" },
          React.createElement("div", { className: "grid gap-6 lg:grid-cols-[1.1fr,0.9fr]" },
            React.createElement("div", { className: "rounded-3xl border border-white/10 bg-white/5 p-6 space-y-4" },
              React.createElement("h3", { className: "text-lg font-semibold" }, t.attest_title),
              React.createElement("div", { className: "flex flex-wrap items-center gap-3" },
                React.createElement("button", {
                  type: "button",
                  onClick: handleBuildRoot,
                  className: "rounded-full bg-indigo-500 px-5 py-2 text-sm font-medium text-white shadow-lg shadow-indigo-700/30 transition hover:bg-indigo-400"
                }, t.btn_build_root),
                claimRes && claimRes.res && !claimRes.res.ok
                  ? React.createElement("span", { className: "text-xs text-amber-300" }, locale === "en-US" ? "Fix validation issues before building a root." : "请先修正校验结果，再生成 Root。")
                  : null
              ),
              root
                ? React.createElement("div", { className: "rounded-2xl border border-white/10 bg-black/30 p-4 text-xs text-white/80 break-all" }, `${t.root}：${root}`)
                : React.createElement("p", { className: "text-sm text-white/70" }, locale === "en-US" ? "Validate the claim first to prepare a Merkle leaf." : "请先完成证据校验，生成 Merkle leaf。"),
              React.createElement("div", { className: "flex flex-wrap items-center gap-3" },
                React.createElement("button", {
                  type: "button",
                  onClick: handleAttest,
                  className: "rounded-full bg-emerald-500 px-5 py-2 text-sm font-medium text-white shadow-lg shadow-emerald-700/30 transition hover:bg-emerald-400 disabled:opacity-40 disabled:cursor-not-allowed",
                  disabled: !root || (claimRes && claimRes.res && !claimRes.res.ok)
                }, t.btn_attest),
                tx
                  ? React.createElement("span", { className: "text-xs text-white/70 break-all" }, `${t.txhash}：${tx}`)
                  : null
              )
            ),
            React.createElement("div", { className: "rounded-3xl border border-white/10 bg-white/5 p-6 space-y-4" },
              React.createElement("h3", { className: "text-lg font-semibold" }, t.validation_result),
              claimRes
                ? React.createElement("div", { className: "max-h-72 overflow-auto rounded-2xl bg-black/30 p-4 text-xs text-white/80" },
                    React.createElement("pre", { className: "whitespace-pre-wrap break-all" }, JSON.stringify(claimRes.summary, null, 2))
                  )
                : React.createElement("p", { className: "text-sm text-white/70" }, locale === "en-US" ? "Validate liquidation evidence to preview the proof payload." : "完成证据校验后，可预览证明 payload。"),
              status.length
                ? React.createElement("div", { className: "space-y-2 text-xs text-white/60" },
                    React.createElement("p", null, locale === "en-US" ? "Latest Merkle root also appears under Status." : "最新 Root 记录可在\"状态追踪\"卡片查看。")
                  )
                : null
            )
          )
        );

        const statusView = React.createElement("div", { className: "space-y-6" },
          React.createElement("div", { className: "rounded-3xl border border-white/10 bg-white/5 p-6 space-y-4" },
            React.createElement("h3", { className: "text-lg font-semibold" }, t.status_title),
            status.length
              ? status.map((item, idx) =>
                  React.createElement("div", { key: idx, className: "rounded-2xl border border-white/10 bg-black/30 p-4 space-y-1 text-xs text-white/70" },
                    React.createElement("div", { className: "text-sm font-semibold text-white" }, item.order),
                    React.createElement("p", null, `${locale === "en-US" ? "Timestamp" : "时间"}：${item.when}`),
                    React.createElement("p", { className: "break-all" }, `root：${item.root}`),
                    React.createElement("p", { className: "break-all" }, `tx：${item.tx || "—"}`),
                    React.createElement("div", { className: "flex flex-wrap gap-2 pt-2" },
                      React.createElement("button", {
                        className: "rounded-full border border-white/15 px-3 py-1 text-xs hover:border-indigo-300/70",
                        onClick: () => copyStatusValue(item.root)
                      }, locale === "en-US" ? "Copy root" : "复制 Root"),
                      item.tx ? React.createElement("button", {
                        className: "rounded-full border border-white/15 px-3 py-1 text-xs hover:border-indigo-300/70",
                        onClick: () => copyStatusValue(item.tx)
                      }, locale === "en-US" ? "Copy tx" : "复制 Tx") : null,
                      item.tx ? React.createElement("a", {
                        className: "rounded-full bg-indigo-500/20 px-3 py-1 text-xs text-indigo-200 hover:bg-indigo-500/40",
                        target: "_blank",
                        rel: "noreferrer",
                        href: `https://basescan.org/tx/${item.tx}`
                      }, "Basescan") : null
                    )
                  )
                : React.createElement("p", { className: "text-sm text-white/70" }, locale === "en-US" ? "No on-chain attestations yet." : "暂未有上链存证记录。")
          ),
          React.createElement("div", { className: "space-y-4" },
            React.createElement("h3", { className: "text-sm font-semibold uppercase tracking-[0.3em] text-white/60" }, t.steps_title),
            React.createElement("div", { className: "grid gap-4 md:grid-cols-2 xl:grid-cols-4" },
              React.createElement(StepCard, { idx: 1, title: t.s1.title, body: t.s1.body, icon: Calculator }),
              React.createElement(StepCard, { idx: 2, title: t.s2.title, body: t.s2.body, icon: Upload }),
              React.createElement(StepCard, { idx: 3, title: t.s3.title, body: t.s3.body, icon: Hash }),
              React.createElement(StepCard, { idx: 4, title: t.s4.title, body: t.s4.body, icon: ListChecks })
            )
          )
        );

        /* -------------------- 帮助文档视图 -------------------- */
        function HelpSection({ title, id, children }) {
          const [isOpen, setIsOpen] = useState(false);
          
          return React.createElement("div", { className: "rounded-3xl border border-white/10 bg-white/5 mb-6 overflow-hidden" },
            React.createElement("button", {
              className: "w-full flex justify-between items-center p-6 text-left",
              onClick: () => setIsOpen(!isOpen)
            },
              React.createElement("h3", { className: "text-lg font-semibold" }, title),
              isOpen ? React.createElement(ChevronUp, { size: 20 }) : React.createElement(ChevronDown, { size: 20 })
            ),
            isOpen && React.createElement("div", { className: "p-6 pt-0 markdown-content" }, children)
          );
        }

        const helpView = React.createElement("div", { className: "space-y-6" },
          React.createElement("div", { className: "rounded-3xl border border-white/10 bg-white/5 p-6" },
            React.createElement("h2", { className: "text-xl font-bold mb-4" }, t.help_title),
            React.createElement("div", { className: "flex flex-wrap gap-2 mb-6" },
              React.createElement("div", { className: "flex items-center gap-1 text-sm text-white/60" },
                React.createElement("a", { 
                  href: "https://wjz5788.com", 
                  target: "_blank", 
                  rel: "noopener noreferrer",
                  className: "flex items-center gap-1 hover:text-indigo-300"
                },
                  "官网 / Website",
                  React.createElement(ExternalLink, { size: 14 })
                )
              ),
              React.createElement("span", { className: "text-white/40" }, "|",
              ),
              React.createElement("div", { className: "flex items-center gap-1 text-sm text-white/60" },
                React.createElement("a", { 
                  href: "https://github.com/wjz5788/leverageguard-attestor", 
                  target: "_blank", 
                  rel: "noopener noreferrer",
                  className: "flex items-center gap-1 hover:text-indigo-300"
                },
                  "GitHub 仓库",
                  React.createElement(ExternalLink, { size: 14 })
                )
              )
            )
          ),
          
          React.createElement(HelpSection, { title: t.project_overview, id: "overview" },
            React.createElement("div", { className: "space-y-4" },
              React.createElement("p", null, "爆仓保（LiqPass）为散户提供高杠杆交易的安全入口。通过\"保费—赔付\"机制，让原本风险厌恶的用户也能参与衍生品交易，从而扩大链上交易量、增加手续费收入，为 Base 生态带来新的用户群体。"),
              React.createElement("p", null, "LiqPass provides retail traders with an insured gateway to high-leverage trading. By introducing a \"premium-payout\" mechanism, it allows risk-averse users to participate in derivative markets safely, expanding on-chain trading volume, boosting transaction fees, and attracting new users to the Base ecosystem.")
            )
          ),
          
          React.createElement(HelpSection, { title: t.why_exchanges, id: "exchanges" },
            React.createElement("div", { className: "space-y-4" },