# LiqPass 风险与不合理点清单（基线版）

ID | 模块 | 标题 | 严重度 | 影响 | 复现 | 修复建议 | Owner | ETA
---|---|---|---|---|---|---|---|---
P0-01 | 支付/资金 | 默认金库地址为 0x…dEaD（黑洞） | P0 | 真实资金不可逆损失 | 阅读后端 `OrderService.DEFAULT_PAYMENT.spenderOrVault` | 配置化 `PAYMENT_VAULT_ADDRESS`，启动即校验非黑洞；在前端下单前校验支付目标地址白名单 | Backend | D1
P0-02 | 订单接口 | 下单/列表接口无鉴权 | P0 | 任意人可创建/枚举订单 | `curl /api/v1/orders` 返回数据；`POST /api/v1/orders` 可匿名创建 | 引入会话/签名校验（JWT/nonce+签名），路由加中间件；按 user_id/钱包隔离 | Backend | D2
P0-03 | 支付校验 | 后端未校验 paymentTx 与 premium 对应关系 | P0 | 伪造已支付订单 | 传任意 `paymentTx` 仍 `status=paid` | 引入回执验证：根据 txHash 查询链上 logs，校验 to/amount/token/chainId 与报价一致，再置 paid | Backend | D3
P0-04 | API 密钥 | 最小闭环接口明文接收 `secret_enc`，且无鉴权 | P0 | 密钥被窃取/滥用 | `POST /api/v1/min/api-accounts` | 改为受控环境使用；生产禁用该路由或加鉴权与加密传输（KMS/AGE） | Backend | D3
P0-05 | 证据一致性 | 无统一序列化与哈希测试向量 | P0 | 证据→Merkle 不可复现 | 目前 evidence_json 任意结构 | 产出“序列化规范+keccak 测试向量”，落库 root 与版本字段 | JP/Backend | D5
P1-06 | CORS/CSRF | 未见全局 CORS/CSRF 策略 | P1 | 跨域滥用/伪造请求 | 检查中间件 | 仅允许受信源，敏感接口要求签名+同源，必要时 CSRF token | Backend | D5
P1-07 | 速率限制 | 无 Rate Limit/限流 | P1 | 暴力/撞库/DoS | - | gateway/路由级滑动窗口限流；鉴权失败指数退避 | DevOps | D6
P1-08 | 重放/幂等 | 支付/赔付缺少幂等键 | P1 | 重放造成重复创建/赔付 | 多次 POST 创建订单成功 | 所有 side-effect 接口引入 idempotency-key，与 server 端存储匹配 | Backend | D6
P1-09 | 日志脱敏 | 未定义密钥/地址脱敏策略 | P1 | 敏感曝光 | - | 日志规范：API Key 后 4 位、地址/哈希局部显示；禁止落盘密钥 | Backend | D6
P1-10 | 赔付路径 | 无赔付上链校验/对账事件 | P1 | 无法审计/对账 | - | 引入 `payout_txs` 与 `audit_events`，前端链上结果回报 | Backend | D7
P2-11 | DB 一致性 | updated_at 触发器不全 | P2 | 数据不一致 | 仅少数表 | 为 orders/claims/payouts/api 账户等加统一触发器 | Backend | D8
P2-12 | 索引 | 高频查询缺索引 | P2 | 慢查询 | 订单/请求列表 | 按 user_id/status/created_at 建联合索引 | Backend | D8
P2-13 | UX/文案 | “保险”措辞与异常引导不足 | P2 | 合规/误导风险 | 前端多处固定文案 | 替换为“保障/赔付”，异常态加操作指引 | Frontend | D9
P2-14 | 透明度 | KPI/事件 Mock 未接主数仓 | P2 | 数据不可信 | Transparency 页 | 接 `audit_events` 聚合视图，逐步替换 Mock | Backend | D10

> 严重度：P0=可被利用且致资金/证据不一致；P1=高风险有缓解；P2=可用性/效率问题。

