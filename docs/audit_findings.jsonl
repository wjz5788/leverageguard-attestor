{"id": "CON-001", "title": "合约缺少基于角色的访问控制（RBAC）", "severity": "P0", "area": "contracts", "file": "contracts/LiqPass.sol", "evidence": "函数未使用 OpenZeppelin 的 Ownable 或 AccessControl", "repro_steps": "直接调用 setPricingFormula 等特权函数", "quick_fix": "所有特权函数增加 `onlyOwner` 修饰符", "long_fix": "引入 OpenZeppelin 的 AccessControl，为不同角色（如 admin, pauser, operator）分配权限", "eta": "4h", "owner": "Contracts Dev", "status": "todo"}
{"id": "CON-002", "title": "USDC 转账未使用 Permit2 或安全 approve 模式", "severity": "P1", "area": "contracts", "file": "contracts/LiqPass.sol", "evidence": "直接使用 `transferFrom`，可能存在 front-running 或 approve 额度滥用风险", "repro_steps": "用户 approve 一个大额度后，合约在未来的交易中可能被利用", "quick_fix": "在每次 `transferFrom` 前，将 allowance 设置为 0，然后再设置为所需额度", "long_fix": "集成 AWS KMS 或 Google Cloud KMS，使用信封加密模式管理所有敏感数据", "eta": "1d", "owner": "Contracts Dev", "status": "todo"}
{"id": "CON-003", "title": "赔付事件未包含足够的索引字段", "severity": "P2", "area": "contracts", "file": "contracts/LiqPass.sol", "evidence": "Claimed 事件的 `orderId` 和 `claimer` 未使用 `indexed` 关键字", "repro_steps": "前端或后端按用户地址过滤赔付历史时，需要扫描所有事件，效率低下", "quick_fix": "为 `Claimed(bytes32 indexed orderId, address indexed claimer, ...)` 事件的关键字段添加 `indexed`", "long_fix": "设计并使用 The Graph 等索引服务来提供高效的事件查询 API", "eta": "2h", "owner": "Contracts Dev", "status": "todo"}
{"id": "JPV-001", "title": "验证服务未对请求来源做 IP 白名单限制", "severity": "P0", "area": "jp-verify", "file": "N/A (infra config)", "evidence": "缺少防火墙或反向代理配置", "repro_steps": "从任意 IP 地址直接请求 `jp-verify:8082/api/verify`", "quick_fix": "在 JP 服务器上使用 UFW/iptables 配置防火墙，仅允许来自 US-backend 的 IP 地址访问 8082 端口", "long_fix": "使用服务网格（如 Istio）或 VPN 建立安全的跨区域服务间通信", "eta": "2h", "owner": "DevOps", "status": "todo"}
{"id": "JPV-002", "title": "OKX API 验证逻辑缺少严格的重放攻击防护", "severity": "P1", "area": "jp-verify", "file": "jp-verify/main.py", "evidence": "时间戳校验窗口过大或 nonce 未被缓存", "repro_steps": "在时间窗口内重放同一个有效的已签名请求", "quick_fix": "将有效时间窗口缩短至 5-10 秒，并使用 Redis 或内存缓存记录近期已处理的 nonce", "long_fix": "为每个 API Key 维护一个严格递增的 nonce 序列，并拒绝任何乱序或重复的 nonce", "eta": "4h", "owner": "Backend Dev (Python)", "status": "todo"}
{"id": "USB-001", "title": "API 密钥在数据库中明文存储", "severity": "P0", "area": "us-backend", "file": "us-backend/src/services/apiKeyService.ts", "evidence": "数据库 schema 中 `api_keys` 表的 `secret_key` 字段为 TEXT 类型，无加密迹象", "repro_steps": "获取数据库访问权限，直接查询 `api_keys` 表即可获得用户密钥", "quick_fix": "使用 AES-256 等对称加密算法对密钥进行静态加密，密钥管理使用环境变量或 KMS", "long_fix": "集成 AWS KMS 或 Google Cloud KMS，使用信封加密模式管理所有敏感数据", "eta": "8h", "owner": "Backend Dev", "status": "todo"}
{"id": "USB-002", "title": "订单处理流程缺少幂等性保证", "severity": "P1", "area": "us-backend", "file": "us-backend/src/routes/orders.ts", "evidence": "创建订单的 API 未检查 `Idempotency-Key`", "repro_steps": "客户端在网络抖动时重试创建订单请求，导致重复创建订单和重复扣款", "quick_fix": "要求创建订单的请求必须包含 `Idempotency-Key` 头，并在后端基于此 key 缓存响应", "long_fix": "建立独立的幂等性校验服务或中间件，处理所有 POST/PUT/PATCH 请求", "eta": "6h", "owner": "Backend Dev", "status": "todo"}
{"id": "USF-001", "title": "前端未对用户输入的 API Key 做显式遮蔽", "severity": "P2", "area": "us-frontend", "file": "us-frontend/src/pages/Settings/ApiKeys.tsx", "evidence": "API Key 输入框为普通 `text` 类型，或在显示时未做处理", "repro_steps": "用户在公共场合操作时，其 API Key 可能被旁人窥视（shoulder surfing）", "quick_fix": "将输入框类型改为 `password`，并在显示已保存的 key 时仅显示前 4 位和后 4 位", "long_fix": "提供一个“点击复制”按钮，而不是直接显示密钥", "eta": "2h", "owner": "Frontend Dev", "status": "todo"}
{"id": "EVI-001", "title": "证据包中缺少订单指纹或父哈希", "severity": "P1", "area": "evidence", "file": "jp-verify/main.py", "evidence": "生成的证据 JSON 结构不完整", "repro_steps": "当出现争议时，无法将单个证据与批量上链的 Merkle Root 关联", "quick_fix": "在证据 JSON 中添加 `orderFingerprint` 和 `merkleRoot` 字段", "long_fix": "设计一个版本化的证据 schema，并使用 JSON Schema 进行校验", "eta": "3h", "owner": "Backend Dev (Python)", "status": "todo"}
{"id": "OPS-001", "title": "服务器缺少磁盘和内存阈值告警", "severity": "P1", "area": "ops", "file": "N/A (infra config)", "evidence": "未部署 Prometheus Node Exporter 或类似监控代理", "repro_steps": "日志文件或数据库持续增长，占满磁盘空间，导致服务崩溃", "quick_fix": "部署 Node Exporter，并配置 Alertmanager，设置磁盘使用率 >85% 和内存使用率 >90% 的告警规则", "long_fix": "建立统一的 Grafana 仪表盘，展示核心服务的健康度、资源使用率和业务指标", "eta": "4h", "owner": "DevOps", "status": "todo"}
{"id": "CMP-001", "title": "产品文案中使用“保险”等高风险词汇", "severity": "P2", "area": "compliance", "file": "us-frontend/src/pages/Landing.tsx", "evidence": "页面文案中出现 `insurance`, `policy` 等词语", "repro_steps": "在受严格监管的地区（如美国）访问网站，可能引发合规风险", "quick_fix": "全局搜索并替换“保险/policy”为“保障/protection”、“赔付/payout”为“补偿/compensation”", "long_fix": "与法务顾问合作，撰写一份详细的《服务条款》和《风险披露》文档，并要求用户在购买前确认", "eta": "8h", "owner": "Product/Legal", "status": "todo"}